<!DOCTYPE html>
<html class="no-js" lang="en">


<%-include('partials/head')%>
<body>
    <!-- Quick view -->
    <div class="modal fade custom-modal" id="quickViewModal" tabindex="-1" aria-labelledby="quickViewModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-6 col-sm-12 col-xs-12">
                            <div class="detail-gallery">
                                <span class="zoom-icon"><i class="fi-rs-search"></i></span>
                                <!-- MAIN SLIDES -->
                                <div class="product-image-slider">
                                    <% if (product.images && Array.isArray(product.images)) { %>
                                        <% product.images.forEach((image, index) => { %>
                                            <figure class="border-radius-10">
                                                <img src="/<%= image %>" alt="<%= product.productName %>">
                                            </figure>
                                        <% }) %>
                                    <% } else { %>
                                        <p>No images available for this product.</p>
                                    <% } %>
                                </div>
                                <!-- THUMBNAILS -->
                                <div class="slider-nav-thumbnails pl-15 pr-15">
                                    <% if (product.images && Array.isArray(product.images)) { %>
                                        <% product.images.forEach((image, index) => { %>
                                            <div><img src="/<%= image %>" alt="<%= product.productName %>"></div>
                                        <% }) %>
                                    <% } %>
                                </div>
                            </div>
                            <!-- End Gallery -->
                        </div>
                        <div class="col-md-6 col-sm-12 col-xs-12">
                            <div class="detail-info">
                                <h3 class="title-detail mt-30"><%= product.productName %></h3>
                                <div class="product-detail-rating">
                                    <div class="pro-details-brand">
                                        <span> Brands: 
                                            <% if (product.brands && product.brands.name) { %>
                                                <a href="shop-grid-right.html"><%= product.brands.name %></a>
                                            <% } else { %>
                                                <span>No brand available</span>
                                            <% } %>
                                        </span>
                                    </div>
                                    <div class="product-rate-cover text-end">
                                        <div class="product-rate d-inline-block">
                                            <div class="product-rating" style="width:90%"></div>
                                        </div>
                                        <span class="font-small ml-5 text-muted"> (25 reviews)</span>
                                    </div>
                                </div>
                                <div class="clearfix product-price-cover">
                                    <div class="product-price primary-color float-left">
                                        <ins><span class="text-brand">$<%= product.price %></span></ins>
                                        <!-- <span class="save-price font-md color3 ml-15">25% Off</span> -->
                                    </div>
                                </div>
                                <div class="bt-1 border-color-1 mt-15 mb-15"></div>
                                <div class="short-desc mb-30">
                                    <p class="font-sm"><%= product.description %></p>
                                </div>
                                <div class="bt-1 border-color-1 mt-30 mb-30"></div>
                                <div class="detail-extralink">
                                    <div class="detail-qty border radius">
                                        <a href="#" class="qty-down"><i class="fi-rs-angle-small-down"></i></a>
                                        <span class="qty-val">1</span>
                                        <a href="#" class="qty-up"><i class="fi-rs-angle-small-up"></i></a>
                                    </div>
                                    <div class="product-extra-link2">
                                        <button type="submit" class="button button-add-to-cart">Add to cart</button>
                                        <a aria-label="Add To Wishlist" class="action-btn hover-up" href="shop-wishlist.html"><i class="fi-rs-heart"></i></a>
                                        <a aria-label="Compare" class="action-btn hover-up" href="shop-compare.html"><i class="fi-rs-shuffle"></i></a>
                                    </div>
                                </div>
                                <ul class="product-meta font-xs color-grey mt-50">
                                    <li>Availability: <span class="in-stock text-success ml-5"><%= product.stock %> Items In Stock</span></li>
                                </ul>
                            </div>
                            <!-- Detail Info -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
   <%-include('partials/header')%>
   
   <main class="main">
    <section class="home-slider position-relative mb-30">
        <div class="container mx-auto">
            <div class="home-slide-cover bg-gray-100 mt-8 rounded-lg overflow-hidden">
                <div class="hero-slider-1 style-4 dot-style-1 dot-style-1-position-1">
                    <!-- Slider 1 -->
                    <div class="single-hero-slider single-animation-wrap">
                        <div class="container mx-auto">
                            <div class="flex flex-col lg:flex-row items-center">
                                <div class="lg:w-5/12 md:w-6/12 p-6">
                                    <div class="hero-slider-content-2">
                                        <h4 class="text-lg font-semibold text-gray-700">Trade-In Offer</h4>
                                        <h3 class="text-3xl font-black text-gray-900 mt-2">Supper Value Deals</h3>
                                        <h2 class="text-4xl font-black text-brand mt-2">On All Products</h2>
                                        <p class="text-gray-600 mt-4">Save more with coupons & up to 70% off</p>
                                        <a class="inline-block mt-6 px-6 py-3 bg-brand text-white rounded-lg hover:bg-brand-dark transition-colors" href="shop-product-right.html">Shop Now</a>
                                    </div>
                                </div>
                                <div class="lg:w-7/12 md:w-6/12">
                                    <div class="single-slider-img w-full h-[300px] md:h-[400px] lg:h-[500px] border-4 border-white rounded-lg overflow-hidden">
                                        <img class="w-full h-full object-cover" src="frontend/imgs/slider/slider-2.jpg" alt="">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Slider 2 -->
                    <div class="single-hero-slider single-animation-wrap">
                        <div class="container mx-auto">
                            <div class="flex flex-col lg:flex-row items-center">
                                <div class="lg:w-5/12 md:w-6/12 p-6">
                                    <div class="hero-slider-content-2">
                                        <h4 class="text-lg font-semibold text-gray-700">Hot promotions</h4>
                                        <h3 class="text-3xl font-black text-gray-900 mt-2">Fashion Trending</h3>
                                        <h2 class="text-4xl font-black text-brand mt-2">Great Collection</h2>
                                        <p class="text-gray-600 mt-4">Save more with coupons & up to 20% off</p>
                                        <a class="inline-block mt-6 px-6 py-3 bg-brand text-white rounded-lg hover:bg-brand-dark transition-colors" href="shop-product-right.html">Get It Now</a>
                                    </div>
                                </div>
                                <div class="lg:w-7/12 md:w-6/12">
                                    <div class="single-slider-img w-full h-[300px] md:h-[400px] lg:h-[500px] border-4 border-white rounded-lg overflow-hidden">
                                        <img class="w-full h-full object-cover" src="frontend/imgs/slider/slider-1.jpg" alt="">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="slider-arrow hero-slider-1-arrow"></div>
            </div>
        </div>
    </section>
    <section class="product-tabs pt-25 pb-20 wow fadeIn animated">
        <div class="container">
            <div class="row">
                <!-- <div class="col-lg-3">
                     
                </div> -->
                <div class="col-lg-12">
                    <!-- Search Bar with Debounce -->
<!-- Search Bar with Debounce -->
<!-- Search Bar with Debounce -->
<div class="tab-header flex flex-wrap items-center p-4 bg-gray-100 rounded-lg gap-2">
    <!-- Search Bar and Buttons Container -->
    <div class="flex flex-wrap items-center gap-2 bg-white p-4 rounded-lg shadow-md">
        <!-- Search Input with Icon -->
        <div class="relative flex items-center">
            <i class="absolute left-3 text-gray-500 lucide lucide-search"></i>
            <input type="text" id="searchInput" placeholder="Search..."
                class="w-48 sm:w-56 md:w-60 lg:w-64 pl-9 pr-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 shadow-sm">
            
            <!-- Cancel Button -->
            <button id="clearBtn"
                class="ml-2 px-4 py-2 bg-gray-500 text-white rounded-md text-sm hover:bg-gray-600 transition-all">
                Cancel
            </button>
        </div>
    
        <!-- Filters and Sorting -->
        <div class="flex flex-wrap items-center gap-3">
            <!-- Sort Dropdown -->
            <div class="flex items-center gap-2">
                <label for="sortBy" class="text-sm text-gray-700 font-medium">Sort:</label>
                <select id="sortBy"
                    class="w-40 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 shadow-sm">
                    <option value="">Sort By</option>
                    <option value="priceLowHigh">Price: Low to High</option>
                    <option value="priceHighLow">Price: High to Low</option>
                    <option value="aToZ">A-Z</option>
                    <option value="zToA">Z-A</option>
                </select>
            </div>
    
            <!-- Category Filter -->
            <div class="flex items-center gap-2">
                <label for="categoryFilter" class="text-sm text-gray-700 font-medium">Category:</label>
                <select id="categoryFilter"
                    class="w-40 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 shadow-sm">
                    <option value="">All Categories</option>
                    <% categories.forEach(cat => { %>
                        <option value="<%= cat.name %>"><%= cat.name %></option>
                    <% }); %>
                </select>
            </div>
    
            <!-- Brand Filter -->
            <div class="flex items-center gap-2">
                <label for="brandFilter" class="text-sm text-gray-700 font-medium">Brand:</label>
                <select id="brandFilter"
                    class="w-40 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 shadow-sm">
                    <option value="">All Brands</option>
                    <% brands.forEach(brand => { %>
                        <option value="<%= brand.name %>"><%= brand.name %></option>
                    <% }); %>
                </select>
            </div>

        </div>
    </div>
    
    
    

                    
                    
                    <!--End nav-tabs-->
                    <div class="tab-content wow fadeIn animated" id="myTabContent">
                        <div class="tab-pane fade show active" id="tab-one" role="tabpanel" aria-labelledby="tab-one">
                            
<div class="row product-grid-4">
    <% if (product.length > 0) { %>
        <% product.forEach(pro => { %>
            <div class="col-lg-3 col-md-4 col-6 col-sm-6 d-flex justify-content-center">
                <div class="product-cart-wrap mb-30">
                    <div class="product-img-action-wrap">
                        <div class="product-img product-img-zoom">
                            <a href="/productdetails/<%= pro._id%>">
                                <img class="default-img" src="/<%= pro.mainImage %>" alt="<%= product.productName %>">
                                <img class="hover-img" src="/<%= pro.images[0] %>" alt="<%= product.productName %>">
                            </a>
                        </div>
                        <div class="product-action-1">
                            <a aria-label="Quick view" class="action-btn hover-up" data-bs-toggle="modal" data-bs-target="#quickViewModal">
                                <i class="fi-rs-eye"></i>
                            </a>
                            <a aria-label="Add To Wishlist" class="action-btn hover-up" href="#">
                                <i class="fi-rs-heart"></i>
                            </a>
                            <a aria-label="Compare" class="action-btn hover-up" href="shop-compare.html">
                                <i class="fi-rs-shuffle"></i>
                            </a>
                        </div>
                        <div class="product-badges product-badges-position product-badges-mrg">
                            <span class="hot"><%= pro.brands.name%></span>
                        </div>
                    </div>
                    <div class="product-content-wrap">
                        <div class="product-category">
                            <a href="shop-grid-right.html"><%= pro.category.name %></a>
                        </div>
                        <h2><a href="/productdetails/<%= pro._id%>"><%= pro.productName %></a></h2>
                        <div class="rating-result" title="90%">
                            <!-- <span>
                                <span>90%</span>
                            </span> -->
                        </div>
                        <div class="product-price">
                            <span>$<%= pro.price %></span>
                            <!-- <span class="old-price">$245.8</span> -->
                        </div>
                        <div class="product-action-1 show">
                            <a aria-label="Add To Cart" class="action-btn hover-up" href="shop-cart.html">
                                <i class="fi-rs-shopping-bag-add"></i>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        <% }) %>
    <% } else { %>
        <div class="col-12">
            <p>No products found.</p>
        </div>
    <% } %>
</div>

                            <!--End product-grid-4-->
                        </div>
                        <!--End tab one (Featured)-->
                    </div>
                    <!--End tab-content-->
                </div>
            </div>
        </div>
    </section>

</main>

    
  <%-include('partials/footer') %>
    <!-- Preloader Start -->
    <%-include('partials/loader') %>
    <!-- Vendor JS-->
   <%-include('partials/script') %>
   <!-- Lucide Icons -->
   <script src="https://unpkg.com/lucide@latest"></script>
   <script>






    document.addEventListener('DOMContentLoaded', function () {
        const searchInput = document.getElementById("searchInput");
        const brandFilter = document.getElementById("brandFilter");
        const categoryFilter = document.getElementById("categoryFilter");
        const sortSelect = document.getElementById("sortBy");

        // Debounce function to delay execution
        function debounce(func, delay) {
            let timer;
            return function (...args) {
                clearTimeout(timer);
                timer = setTimeout(() => func.apply(this, args), delay);
            };
        }

        // Apply filters when input changes (debounced)
        function applyFilters() {
            const queryParams = new URLSearchParams();

            // Get all filter values
            const search = searchInput.value.trim();
            const brand = brandFilter.value;
            const category = categoryFilter.value;
            const sort = sortSelect?.value;

            // Add non-empty filters to query params
            if (search) queryParams.append("search", search);
            if (brand) queryParams.append("brandsFilter", brand);
            if (category) queryParams.append("categoryFilter", category);
            if (sort) queryParams.append("sortBy", sort);

            // Navigate to filtered URL
            window.location.href = `/?${queryParams.toString()}`;
        }

        // Debounced function for search input
        const debouncedSearch = debounce(applyFilters, 500); // Adjust delay as needed

        // Add event listeners
        searchInput.addEventListener("input", debouncedSearch);
        brandFilter.addEventListener("change", applyFilters);
        categoryFilter.addEventListener("change", applyFilters);
        sortSelect?.addEventListener("change", applyFilters);

        // Restore filter values from URL on page load
        function restoreFiltersFromURL() {
            const params = new URLSearchParams(window.location.search);
            searchInput.value = params.get("search") || "";
            brandFilter.value = params.get("brandsFilter") || "";
            categoryFilter.value = params.get("categoryFilter") || "";
            if (sortSelect) sortSelect.value = params.get("sortBy") || "";
        }

        // Initialize filters from URL
        restoreFiltersFromURL();
    });
</script>

</body>

</html>

