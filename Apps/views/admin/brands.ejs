<!DOCTYPE HTML>
<html lang="en">
    <%- include('partials/head') %>

<body>
    <div class="screen-overlay"></div>
    <aside class="navbar-aside" id="offcanvas_aside">
        <div class="aside-top">
            <a href="" class="brand-wrap">
                <img src="/backend/imgs/logos/cyclonelogo.png" class="logo" alt="CycloneX Dashboard">
            </a>
            <div>
                <button class="btn btn-icon btn-aside-minimize"> <i class="text-muted material-icons md-menu_open"></i> </button>
            </div>
        </div>
        <nav>
            <ul class="menu-aside">
                <li class="menu-item">
                    <a class="menu-link" href="/admin/dashboard"> <i class="icon material-icons md-home"></i>
                        <span class="text">Dashboard</span>
                    </a>
                </li>
                <li class="menu-item ">
                    <a class="menu-link " href="/admin/product-list2"> <i class="icon material-icons md-shopping_bag"></i>
                        <span class="text">Products</span>
                    </a>
                </li>
    
                
                <li class="menu-item ">
                    <a class="menu-link" href="/admin/addproduct"> <i class="icon material-icons md-add_box"></i>
                        <span class="text">Add product</span>
                    </a>
                  
                </li>
                
                <li class="menu-item">
                    <a class="menu-link" href="/admin/category">  <i class="icon material-icons md-category"></i>
                        <span class="text">category</span>
                    </a>
                </li>
    
    
    
                <li class="menu-item active">
                    <a class="menu-link" href="/admin/brands"> <i class="icon material-icons md-stars"></i>
                        <span class="text">Brands</span> </a>
                </li>
               
            </ul>
            <hr>
            <ul class="menu-aside">
                <li class="menu-item has-submenu">
                    <a class="menu-link" href="page-settings-1.html"> <i class="icon material-icons md-settings"></i>
                        <span class="text">Settings</span>
                    </a>
                </li>
            </ul>
            <br>
            <br>
        </nav>
    </aside>
    <main class="main-wrap">
        <%- include('partials/header') %>
        <section class="content-main">
            <div class="content-header">
                <div>
                    <h2 class="content-title card-title">Brand </h2>
                    <p>Brand and vendor management</p>
                </div>
                <div>
                    <a href="/admin/addbrand" class="btn btn-primary"><i class="text-muted material-icons md-post_add"></i>Add New Brand</a>
                </div>
            </div>
            <div class="card mb-4">
                <header class="card-header">
                  <div class="row gx-3">
                    <div class="col-lg-4 mb-lg-0 mb-15 me-auto">
                      <input type="text" placeholder="Search..." class="form-control">
                    </div>
                    <div class="col-lg-2 col-6">
                      <div class="custom_select">
                        <select class="form-select select-nice">
                          <option selected>Categories</option>
                          <option>Technology</option>
                          <option>Fashion</option>
                          <option>Home Decor</option>
                          <option>Healthy</option>
                          <option>Travel</option>
                          <option>Auto-car</option>
                        </select>
                      </div>
                    </div>
                    <div class="col-lg-2 col-6">
                      <input type="date" class="form-control" name="">
                    </div>
                  </div>
                </header> <!-- card-header end// -->
                <div class="card-body">
                  <div class="row gx-3">
                    <% brands.forEach(brand => { 
                        if (!brand.isBlocked) { // Show only active brands
                    %>
                        <div class="col-xl-2 col-lg-3 col-md-4 col-6">
                            <figure class="card border-1">
                                <div class="card-header bg-white text-center">
                                    <img height="76" src="<%= brand.image %>" class="img-fluid" alt="<%= brand.name %>">
                                </div>
                                <figcaption class="card-body text-center">
                                    <h6 class="card-title m-0"><%= brand.name %></h6>
                                    <p><%= brand.description %></p>
                                    <div class="mt-2">
                                        <a href="/admin/editbrand/<%= brand.id %>" class="btn btn-sm btn-info editBrandForm" data-id="<%= brand.id %>">Edit</a>
                                        <button data-id="<%= brand.id %>" class="btn btn-sm btn-danger delete-brand">Delete</button>
                                    </div>
                                </figcaption>
                            </figure>
                        </div>
                    <% }}); %>
                    
                  </div> <!-- row.// -->
                </div> <!-- card-body end// -->
              </div><!-- card end// -->
        </section> <!-- content-main end// -->
        <%- include('partials/footer') %>
    </main>
    <%- include('partials/scripts') %>
    <script>
        document.querySelectorAll(".delete-brand").forEach(button => {
          button.addEventListener("click", async function (event) {
            event.preventDefault();
            const brandId = this.getAttribute("data-id");
            
            if (confirm("Are you sure you want to edit this brand?")) {
             try {
                const response = await fetch(`/admin/deletebrand/${brandId}`,{
                    method:"DELETE"
                })
                const data = await response.json()
                if(response.ok && data.success){
alert('brand deleted successfully')
location.reload()
                }
                else{
                alert(`error:${data.message}`)
                }
             } catch (error) {
                    console.error("Error deleting brand:", error);
                    alert("An error occurred. Please try again.");
                }
            }
          });
        });
      </script>
      
   
</body>

</html>