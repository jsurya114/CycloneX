<!DOCTYPE HTML>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CycloneX Dashboard</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
      tailwind.config = {
          darkMode: 'class',
          theme: {
              extend: {
                  colors: {
                      primary: {
                          50: '#f0f9ff',
                          100: '#e0f2fe',
                          200: '#bae6fd',
                          300: '#7dd3fc',
                          400: '#38bdf8',
                          500: '#0ea5e9',
                          600: '#0284c7',
                          700: '#0369a1',
                          800: '#075985',
                          900: '#0c4a6e',
                          950: '#082f49',
                      },
                      secondary: {
                          50: '#f5f3ff',
                          100: '#ede9fe',
                          200: '#ddd6fe',
                          300: '#c4b5fd',
                          400: '#a78bfa',
                          500: '#8b5cf6',
                          600: '#7c3aed',
                          700: '#6d28d9',
                          800: '#5b21b6',
                          900: '#4c1d95',
                          950: '#2e1065',
                      },
                  },
              },
          },
      }
  </script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
  <style>
      body {
          font-family: 'Inter', sans-serif;
      }
      
      .scrollbar-hide::-webkit-scrollbar {
          display: none;
      }
      
      .scrollbar-hide {
          -ms-overflow-style: none;
          scrollbar-width: none;
      }
      
      .stat-card {
          transition: all 0.3s ease;
      }
      
      .stat-card:hover {
          transform: translateY(-5px);
          box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
      }
      
      .chart-container {
          position: relative;
          height: 300px;
          width: 100%;
      }
      
      .table-container {
          overflow-x: auto;
      }
      
      @media (max-width: 768px) {
          .chart-container {
              height: 250px;
          }
      }
  </style>
</head>
<body class="bg-gray-50 font-sans">
  <!-- Main Container -->
  <div class="flex h-screen overflow-hidden">
    <!-- Overlay for mobile sidebar -->
    <div id="overlay" class="fixed inset-0 bg-black/50 z-20 hidden lg:hidden"></div>
    
    <!-- Sidebar -->
    <aside id="sidebar" class="fixed lg:static inset-y-0 left-0 z-50 w-64 bg-white border-r border-gray-200 shadow-lg transform transition-transform duration-300 ease-in-out -translate-x-full lg:translate-x-0 flex-shrink-0">
      <div class="flex flex-col h-full">
        <!-- Logo Area -->
        <div class="flex items-center justify-between h-16 px-6 border-b border-gray-200">
          <a href="/admin/dashboard" class="flex items-center space-x-2">
            <div class="bg-gradient-to-r from-primary-600 to-secondary-600 p-1.5 rounded-lg">
              <img src="/backend/imgs/logos/cyclonelogo.png" class="h-6 w-6" alt="CycloneX Dashboard">
            </div>
            <span class="text-xl font-bold text-gray-800">CycloneX</span>
          </a>
          <button id="closeSidebar" class="lg:hidden text-gray-500 hover:text-gray-700">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
            </svg>
          </button>
        </div>
        
        <!-- Navigation -->
        <nav class="flex-1 px-4 py-4 overflow-y-auto scrollbar-hide">
          <div class="space-y-1">
            <p class="px-2 text-xs font-semibold text-gray-400 uppercase tracking-wider">Main</p>
            
            <a href="/admin/dashboard" class="flex items-center px-3 py-2.5 text-sm font-medium bg-primary-50 text-primary-700 rounded-lg hover:bg-gray-100 group">
              <i class="fas fa-home w-5 h-5 mr-2 text-primary-700"></i>
              <span>Dashboard</span>
            </a>
            
            <a href="/admin/product-list2" class="flex items-center px-3 py-2.5 text-sm font-medium text-gray-700 rounded-lg hover:bg-gray-100 group">
              <i class="fas fa-shopping-bag w-5 h-5 mr-2 text-gray-500 group-hover:text-gray-700"></i>
              <span>Products</span>
            </a>
            
            <a href="/admin/category" class="flex items-center px-3 py-2.5 text-sm font-medium text-gray-700 rounded-lg hover:bg-gray-100 group">
              <i class="fas fa-tags w-5 h-5 mr-2 text-gray-500 group-hover:text-gray-700"></i>
              <span>Categories</span>
            </a>
            
            <a href="/admin/brands" class="flex items-center px-3 py-2.5 text-sm font-medium text-gray-700 rounded-lg hover:bg-gray-100 group">
              <i class="fas fa-star w-5 h-5 mr-2 text-gray-500 group-hover:text-gray-700"></i>
              <span>Brands</span>
            </a>
          </div>
          
          <a href="/admin/salesreport" class="flex items-center px-3 py-2.5 text-sm font-medium text-gray-700 rounded-lg hover:bg-gray-100 group">
            <i class="fas fa-chart-line w-5 h-5 mr-2 text-gray-500 group-hover:text-gray-700"></i>
            <span>Sales Report</span>
          </a>
          
          <div class="mt-8 space-y-1">
            <p class="px-2 text-xs font-semibold text-gray-400 uppercase tracking-wider">Management</p>
            
            <a href="/admin/userlist" class="flex items-center px-3 py-2.5 text-sm font-medium text-gray-700 rounded-lg hover:bg-gray-100 group">
              <i class="fas fa-users w-5 h-5 mr-2 text-gray-500 group-hover:text-gray-700"></i>
              <span>Users</span>
            </a>

            
            <a href="/admin/adminwallet" class="flex items-center px-3 py-2.5 text-sm font-medium text-gray-700 rounded-lg hover:bg-gray-100 group">             

              <i class="fas fa-wallet w-5 h-5 mr-2 text-primary-700"></i>
              <span>Wallet</span>
            </a>
            
            
            <a href="/admin/coupons" class="flex items-center px-3 py-2.5 text-sm font-medium text-gray-700 rounded-lg hover:bg-gray-100 group">
              <i class="fas fa-gift w-5 h-5 mr-2 text-gray-500 group-hover:text-gray-700"></i>
              <span>Coupons</span>
            </a>
            
            <a href="/admin/orderlist" class="flex items-center px-3 py-2.5 text-sm font-medium rounded-lg text-gray-700 group">
              <i class="fas fa-clipboard-list w-5 h-5 mr-2 text-gray-500 group-hover:text-gray-700"></i>
              <span>Orders</span>
            </a>
            
            <a href="/admin/Logout" class="flex items-center px-3 py-2.5 text-sm font-medium text-gray-700 rounded-lg hover:bg-gray-100 group">
              <i class="fas fa-sign-out-alt w-5 h-5 mr-2 text-gray-500 group-hover:text-gray-700"></i>
              <span>Logout</span>
            </a>
          </div>
        </nav>
      </div>
    </aside>

    <!-- Main Content Area -->
    <div class="flex-1 flex flex-col overflow-hidden">
      <!-- Header -->
      <header class="bg-white border-b border-gray-200 shadow-sm">
        <div class="flex items-center justify-between h-16 px-6">
          <!-- Left: Hamburger Menu -->
          <div class="flex items-center">
            <button id="openSidebar" class="lg:hidden text-gray-500 hover:text-gray-700 focus:outline-none">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
              </svg>
            </button>
            <div class="hidden md:flex items-center ml-4">
              <h1 class="text-xl font-semibold text-gray-800">Dashboard</h1>
              <span class="ml-2 px-2 py-0.5 text-xs font-medium bg-primary-100 text-primary-800 rounded-full">Admin</span>
            </div>
          </div>
          
          <!-- Right: Refresh Button -->
          <button id="refreshBtn" class="flex items-center px-3 py-1.5 text-sm font-medium rounded-lg bg-primary-50 text-primary-700 hover:bg-primary-100 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2">
            <i class="fas fa-sync-alt mr-2"></i>
            Refresh
          </button>
        </div>
      </header>

      <!-- Main Content - Scrollable area -->
      <main class="flex-1 overflow-y-auto bg-gray-50 p-6">
        <!-- Page Header -->
        <div class="flex flex-col md:flex-row md:items-center md:justify-between mb-6">
          <div class="mb-4 md:mb-0">
            <h2 class="text-2xl font-bold text-gray-900">Dashboard Overview</h2>
            <p class="text-sm text-gray-600">Monitor your store's performance and analytics</p>
          </div>
          
         <!-- Time Filter and Download PDF -->
<div class="flex flex-wrap items-center gap-2">
  <form id="timeFilterForm" method="GET" action="/admin/dashboard" class="flex flex-wrap gap-2">
    <button type="button" class="time-filter-btn px-4 py-2 text-sm font-medium rounded-lg border <%= timeFilter === 'daily' ? 'bg-primary-500 text-white border-primary-500' : 'bg-white text-gray-700 border-gray-300' %> hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2" data-value="daily">
      Daily
    </button>
    <button type="button" class="time-filter-btn px-4 py-2 text-sm font-medium rounded-lg border <%= timeFilter === 'weekly' ? 'bg-primary-500 text-white border-primary-500' : 'bg-white text-gray-700 border-gray-300' %> hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2" data-value="weekly">
      Weekly
    </button>
    <button type="button" class="time-filter-btn px-4 py-2 text-sm font-medium rounded-lg border <%= timeFilter === 'monthly' ? 'bg-primary-500 text-white border-primary-500' : 'bg-white text-gray-700 border-gray-300' %> hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2" data-value="monthly">
      Monthly
    </button>
    <button type="button" class="time-filter-btn px-4 py-2 text-sm font-medium rounded-lg border <%= timeFilter === 'yearly' ? 'bg-primary-500 text-white border-primary-500' : 'bg-white text-gray-700 border-gray-300' %> hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2" data-value="yearly">
      Yearly
    </button>
    <input type="hidden" name="timeFilter" id="timeFilterInput" value="<%= timeFilter %>">
  </form>

  <!-- Download PDF Button -->
  <a href="/admin/dashboard/download-pdf?timeFilter=<%= timeFilter %>" class="flex items-center px-4 py-2 text-sm font-medium rounded-lg border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 ml-2">
    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
    </svg>
    Download PDF
  </a>
</div>
        </div>
        
        <!-- Stats Cards Row 1 -->
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-6">
          <!-- Total Orders -->
          <div class="stat-card bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden">
            <div class="p-5">
              <div class="flex items-center">
                <div class="flex-shrink-0 bg-primary-100 rounded-full p-3">
                  <i class="fas fa-shopping-cart text-primary-600 text-xl"></i>
                </div>
                <div class="ml-5">
                  <p class="text-sm font-medium text-gray-500 uppercase">Total Orders</p>
                  <h3 class="text-2xl font-bold text-gray-900 mt-1"><%= totalOrders %></h3>
                </div>
              </div>
              <div class="mt-4 border-t border-gray-100 pt-4">
                <div class="flex items-center">
                  <span class="text-green-500 flex items-center text-sm font-medium">
                    <i class="fas fa-arrow-up mr-1"></i> 12.5%
                  </span>
                  <span class="text-gray-500 text-sm ml-2">from previous period</span>
                </div>
              </div>
            </div>
          </div>
          
          <!-- Total Revenue -->
          <div class="stat-card bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden">
            <div class="p-5">
              <div class="flex items-center">
                <div class="flex-shrink-0 bg-green-100 rounded-full p-3">
                  <i class="fas fa-rupee-sign text-green-600 text-xl"></i>
                </div>
                <div class="ml-5">
                  <p class="text-sm font-medium text-gray-500 uppercase">Total Revenue</p>
                  <h3 class="text-2xl font-bold text-gray-900 mt-1">₹<%= totalRevenue.toFixed(2) %></h3>
                </div>
              </div>
              <div class="mt-4 border-t border-gray-100 pt-4">
                <div class="flex items-center">
                  <span class="text-green-500 flex items-center text-sm font-medium">
                    <i class="fas fa-arrow-up mr-1"></i> 8.2%
                  </span>
                  <span class="text-gray-500 text-sm ml-2">from previous period</span>
                </div>
              </div>
            </div>
          </div>
          
          <!-- Pending Orders -->
          <div class="stat-card bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden">
            <div class="p-5">
              <div class="flex items-center">
                <div class="flex-shrink-0 bg-yellow-100 rounded-full p-3">
                  <i class="fas fa-clock text-yellow-600 text-xl"></i>
                </div>
                <div class="ml-5">
                  <p class="text-sm font-medium text-gray-500 uppercase">Pending Orders</p>
                  <h3 class="text-2xl font-bold text-gray-900 mt-1"><%= pendingOrders %></h3>
                </div>
              </div>
              <div class="mt-4 border-t border-gray-100 pt-4">
                <div class="flex items-center">
                  <span class="text-red-500 flex items-center text-sm font-medium">
                    <i class="fas fa-arrow-up mr-1"></i> 2.3%
                  </span>
                  <span class="text-gray-500 text-sm ml-2">from previous period</span>
                </div>
              </div>
            </div>
          </div>
          
          <!-- Delivered Orders -->
          <div class="stat-card bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden">
            <div class="p-5">
              <div class="flex items-center">
                <div class="flex-shrink-0 bg-blue-100 rounded-full p-3">
                  <i class="fas fa-truck text-blue-600 text-xl"></i>
                </div>
                <div class="ml-5">
                  <p class="text-sm font-medium text-gray-500 uppercase">Delivered Orders</p>
                  <h3 class="text-2xl font-bold text-gray-900 mt-1"><%= deliveredOrders %></h3>
                </div>
              </div>
              <div class="mt-4 border-t border-gray-100 pt-4">
                <div class="flex items-center">
                  <span class="text-green-500 flex items-center text-sm font-medium">
                    <i class="fas fa-arrow-up mr-1"></i> 5.7%
                  </span>
                  <span class="text-gray-500 text-sm ml-2">from previous period</span>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Stats Cards Row 2 -->
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-6">
          <!-- Processing -->
          <div class="stat-card bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden">
            <div class="p-5">
              <div class="flex items-center">
                <div class="flex-shrink-0 bg-indigo-100 rounded-full p-3">
                  <i class="fas fa-cogs text-indigo-600 text-xl"></i>
                </div>
                <div class="ml-5">
                  <p class="text-sm font-medium text-gray-500 uppercase">Processing</p>
                  <h3 class="text-2xl font-bold text-gray-900 mt-1"><%= processingOrders %></h3>
                </div>
              </div>
            </div>
          </div>
          
          <!-- Shipped -->
          <div class="stat-card bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden">
            <div class="p-5">
              <div class="flex items-center">
                <div class="flex-shrink-0 bg-purple-100 rounded-full p-3">
                  <i class="fas fa-box text-purple-600 text-xl"></i>
                </div>
                <div class="ml-5">
                  <p class="text-sm font-medium text-gray-500 uppercase">Shipped</p>
                  <h3 class="text-2xl font-bold text-gray-900 mt-1"><%= shippedOrders %></h3>
                </div>
              </div>
            </div>
          </div>
          
          <!-- Cancelled -->
          <div class="stat-card bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden">
            <div class="p-5">
              <div class="flex items-center">
                <div class="flex-shrink-0 bg-red-100 rounded-full p-3">
                  <i class="fas fa-times-circle text-red-600 text-xl"></i>
                </div>
                <div class="ml-5">
                  <p class="text-sm font-medium text-gray-500 uppercase">Cancelled</p>
                  <h3 class="text-2xl font-bold text-gray-900 mt-1"><%= cancelledOrders %></h3>
                </div>
              </div>
            </div>
          </div>
          
          <!-- Returned -->
          <div class="stat-card bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden">
            <div class="p-5">
              <div class="flex items-center">
                <div class="flex-shrink-0 bg-gray-100 rounded-full p-3">
                  <i class="fas fa-undo text-gray-600 text-xl"></i>
                </div>
                <div class="ml-5">
                  <p class="text-sm font-medium text-gray-500 uppercase">Returned</p>
                  <h3 class="text-2xl font-bold text-gray-900 mt-1"><%= returnedOrders %></h3>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Charts Row -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
          <!-- Revenue Overview Chart -->
          <div class="lg:col-span-2 bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden">
            <div class="p-5">
              <div class="flex items-center justify-between mb-4">
                <h3 class="text-lg font-semibold text-gray-900">Revenue Overview</h3>
                <div class="flex items-center space-x-2">
                  <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">
                    <i class="fas fa-arrow-up mr-1"></i> 12.5%
                  </span>
                </div>
              </div>
              <div class="chart-container">
                <canvas id="revenueChart"></canvas>
              </div>
            </div>
          </div>
          
          <!-- Order Status Chart -->
          <div class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden">
            <div class="p-5">
              <div class="flex items-center justify-between mb-4">
                <h3 class="text-lg font-semibold text-gray-900">Order Status</h3>
              </div>
              <div class="chart-container">
                <canvas id="orderStatusChart"></canvas>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Payment Methods & Top Products -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
          <!-- Payment Methods Chart -->
          <div class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden">
            <div class="p-5">
              <div class="flex items-center justify-between mb-4">
                <h3 class="text-lg font-semibold text-gray-900">Payment Methods</h3>
              </div>
              <div class="chart-container">
                <canvas id="paymentMethodChart"></canvas>
              </div>
            </div>
          </div>
          
          <!-- Top Products Chart -->
          <div class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden">
            <div class="p-5">
              <div class="flex items-center justify-between mb-4">
                <h3 class="text-lg font-semibold text-gray-900">Top Products by Revenue</h3>
              </div>
              <div class="chart-container">
                <canvas id="topProductsChart"></canvas>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Top Categories & Brands Charts -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
          <!-- Top Categories Chart -->
          <div class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden">
            <div class="p-5">
              <div class="flex items-center justify-between mb-4">
                <h3 class="text-lg font-semibold text-gray-900">Top Categories by Revenue</h3>
              </div>
              <div class="chart-container">
                <canvas id="topCategoriesChart"></canvas>
              </div>
            </div>
          </div>
          
          <!-- Top Brands Chart -->
          <div class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden">
            <div class="p-5">
              <div class="flex items-center justify-between mb-4">
                <h3 class="text-lg font-semibold text-gray-900">Top Brands by Revenue</h3>
              </div>
              <div class="chart-container">
                <canvas id="topBrandsChart"></canvas>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Top 10 Best Selling Products -->
        <div class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden mb-6">
          <div class="p-5">
            <div class="flex items-center justify-between mb-4">
              <h3 class="text-lg font-semibold text-gray-900">Top 10 Best Selling Products</h3>
              <button class="px-3 py-1.5 text-xs font-medium rounded-lg bg-primary-50 text-primary-700 hover:bg-primary-100 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2">
                View All
              </button>
            </div>
            <div class="table-container">
              <table class="min-w-full divide-y divide-gray-200">
                <thead class="bg-gray-50">
                  <tr>
                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Image</th>
                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Product Name</th>
                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Category</th>
                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Brand</th>
                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Price</th>
                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Stock</th>
                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Total Sold</th>
                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Revenue</th>
                  </tr>
                </thead>
                <tbody id="topSellingProductsBody" class="bg-white divide-y divide-gray-200">
                  <!-- Populated by JavaScript -->
                </tbody>
              </table>
            </div>
          </div>
        </div>
        
        <!-- Top 10 Best Selling Categories -->
        <div class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden mb-6">
          <div class="p-5">
            <div class="flex items-center justify-between mb-4">
              <h3 class="text-lg font-semibold text-gray-900">Top 10 Best Selling Categories</h3>
              <button class="px-3 py-1.5 text-xs font-medium rounded-lg bg-primary-50 text-primary-700 hover:bg-primary-100 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2">
                View All
              </button>
            </div>
            <div class="table-container">
              <table class="min-w-full divide-y divide-gray-200">
                <thead class="bg-gray-50">
                  <tr>
                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Category Name</th>
                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Description</th>
                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Product Count</th>
                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Total Items Sold</th>
                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Revenue</th>
                  </tr>
                </thead>
                <tbody id="topSellingCategoriesBody" class="bg-white divide-y divide-gray-200">
                  <!-- Populated by JavaScript -->
                </tbody>
              </table>
            </div>
          </div>
        </div>
        
        <!-- Top 10 Best Selling Brands -->
        <div class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden mb-6">
          <div class="p-5">
            <div class="flex items-center justify-between mb-4">
              <h3 class="text-lg font-semibold text-gray-900">Top 10 Best Selling Brands</h3>
              <button class="px-3 py-1.5 text-xs font-medium rounded-lg bg-primary-50 text-primary-700 hover:bg-primary-100 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2">
                View All
              </button>
            </div>
            <div class="table-container">
              <table class="min-w-full divide-y divide-gray-200">
                <thead class="bg-gray-50">
                  <tr>
                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Brand Name</th>
                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Description</th>
                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Product Count</th>
                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Total Items Sold</th>
                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Revenue</th>
                  </tr>
                </thead>
                <tbody id="topSellingBrandsBody" class="bg-white divide-y divide-gray-200">
                  <!-- Populated by JavaScript -->
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </main>
      
      <!-- Footer -->
      <footer class="bg-white border-t border-gray-200 py-4 px-6">
        <div class="flex flex-col md:flex-row justify-between items-center">
          <p class="text-sm text-gray-500">© 2023 CycloneX. All rights reserved.</p>
          <div class="flex space-x-4 mt-2 md:mt-0">
            <a href="#" class="text-gray-400 hover:text-gray-600">
              <i class="fab fa-facebook"></i>
            </a>
            <a href="#" class="text-gray-400 hover:text-gray-600">
              <i class="fab fa-twitter"></i>
            </a>
            <a href="#" class="text-gray-400 hover:text-gray-600">
              <i class="fab fa-instagram"></i>
            </a>
          </div>
        </div>
      </footer>
    </div>
  </div>

  <script>
    // Toast notification function
    function showToast(message, isSuccess = true) {
      Toastify({
        text: message,
        duration: 3000,
        gravity: "bottom",
        position: "center",
        backgroundColor: isSuccess ? "#4CAF50" : "#F44336",
        stopOnFocus: true,
        className: "rounded-lg",
        style: {
          boxShadow: "0 3px 6px rgba(0,0,0,0.16), 0 3px 6px rgba(0,0,0,0.23)"
        }
      }).showToast();
    }

    // Mobile sidebar toggle
    document.addEventListener('DOMContentLoaded', function() {
      const sidebar = document.getElementById('sidebar');
      const overlay = document.getElementById('overlay');
      const openSidebarBtn = document.getElementById('openSidebar');
      const closeSidebarBtn = document.getElementById('closeSidebar');
      const refreshBtn = document.getElementById('refreshBtn');
      
      function openSidebar() {
        sidebar.classList.remove('-translate-x-full');
        overlay.classList.remove('hidden');
        document.body.classList.add('overflow-hidden', 'lg:overflow-auto');
      }
      
      function closeSidebar() {
        sidebar.classList.add('-translate-x-full');
        overlay.classList.add('hidden');
        document.body.classList.remove('overflow-hidden', 'lg:overflow-auto');
      }
      
      if (openSidebarBtn) {
        openSidebarBtn.addEventListener('click', openSidebar);
      }
      
      if (closeSidebarBtn) {
        closeSidebarBtn.addEventListener('click', closeSidebar);
      }
      
      if (overlay) {
        overlay.addEventListener('click', closeSidebar);
      }
      
      // Refresh button functionality
      if (refreshBtn) {
        refreshBtn.addEventListener('click', function() {
          showToast('Refreshing dashboard data...', true);
          setTimeout(() => {
            window.location.reload();
          }, 1000);
        });
      }
      
      // Close sidebar on window resize if screen becomes large
      window.addEventListener('resize', function() {
        if (window.innerWidth >= 1024) {
          closeSidebar();
        }
      });
      
      // Time filter buttons
      const timeFilterBtns = document.querySelectorAll('.time-filter-btn');
      const timeFilterInput = document.getElementById('timeFilterInput');
      const timeFilterForm = document.getElementById('timeFilterForm');
      
      timeFilterBtns.forEach(btn => {
        btn.addEventListener('click', function() {
          const value = this.getAttribute('data-value');
          timeFilterInput.value = value;
          showToast(`Filtering data by ${value} view`, true);
          timeFilterForm.submit();
        });
      });
      
      // Parse data from server
      const timeLabels = <%- timeLabels %>;
      const salesData = <%- salesData %>;
      const paymentMethodStats = <%- paymentMethodStats %>;
      const orderStatusStats = <%- orderStatusStats %>;
      const topProducts = <%- topProducts %>;
      const topSellingProducts = <%- topSellingProducts %>;
      const topSellingCategories = <%- topSellingCategories %>;
      const topSellingBrands = <%- topSellingBrands %>;
      
      // Set up Revenue Chart
      const revenueCtx = document.getElementById('revenueChart').getContext('2d');
      new Chart(revenueCtx, {
        type: 'line',
        data: {
          labels: timeLabels,
          datasets: [{
            label: 'Revenue',
            data: salesData,
            backgroundColor: 'rgba(14, 165, 233, 0.1)',
            borderColor: 'rgba(14, 165, 233, 1)',
            borderWidth: 2,
            tension: 0.4,
            pointBackgroundColor: 'rgba(14, 165, 233, 1)',
            pointBorderColor: '#fff',
            pointBorderWidth: 2,
            pointRadius: 4,
            pointHoverRadius: 6,
            fill: true
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            y: {
              beginAtZero: true,
              grid: {
                color: 'rgba(0, 0, 0, 0.05)'
              },
              ticks: {
                callback: function(value) {
                  return '₹' + value;
                }
              }
            },
            x: {
              grid: {
                display: false
              }
            }
          },
          plugins: {
            legend: {
              display: false
            },
            tooltip: {
              backgroundColor: 'rgba(0, 0, 0, 0.8)',
              padding: 12,
              titleFont: {
                size: 14,
                weight: 'bold'
              },
              bodyFont: {
                size: 13
              },
              callbacks: {
                label: function(context) {
                  return '₹' + context.raw.toFixed(2);
                }
              }
            }
          }
        }
      });
      
      // Set up Order Status Chart
      const orderStatusCtx = document.getElementById('orderStatusChart').getContext('2d');
      const statusLabels = orderStatusStats.map(item => item._id);
      const statusData = orderStatusStats.map(item => item.count);
      const statusColors = [
        'rgba(14, 165, 233, 0.8)',
        'rgba(34, 197, 94, 0.8)',
        'rgba(139, 92, 246, 0.8)',
        'rgba(249, 115, 22, 0.8)',
        'rgba(239, 68, 68, 0.8)',
        'rgba(107, 114, 128, 0.8)'
      ];
      
      new Chart(orderStatusCtx, {
        type: 'doughnut',
        data: {
          labels: statusLabels,
          datasets: [{
            data: statusData,
            backgroundColor: statusColors.slice(0, statusLabels.length),
            borderWidth: 0,
            hoverOffset: 10
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          cutout: '70%',
          plugins: {
            legend: {
              position: 'right',
              labels: {
                boxWidth: 12,
                padding: 15,
                font: {
                  size: 12
                }
              }
            },
            tooltip: {
              backgroundColor: 'rgba(0, 0, 0, 0.8)',
              padding: 12,
              titleFont: {
                size: 14,
                weight: 'bold'
              },
              bodyFont: {
                size: 13
              }
            }
          }
        }
      });
      
      // Set up Payment Method Chart
      const paymentCtx = document.getElementById('paymentMethodChart').getContext('2d');
      const paymentLabels = paymentMethodStats.map(item => item._id);
      const paymentData = paymentMethodStats.map(item => item.count);
      const paymentColors = [
        'rgba(14, 165, 233, 0.8)',
        'rgba(34, 197, 94, 0.8)',
        'rgba(139, 92, 246, 0.8)',
        'rgba(249, 115, 22, 0.8)',
        'rgba(239, 68, 68, 0.8)'
      ];
      
      new Chart(paymentCtx, {
        type: 'bar',
        data: {
          labels: paymentLabels,
          datasets: [{
            label: 'Orders',
            data: paymentData,
            backgroundColor: paymentColors.slice(0, paymentLabels.length),
            borderRadius: 6,
            borderWidth: 0
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            y: {
              beginAtZero: true,
              grid: {
                color: 'rgba(0, 0, 0, 0.05)'
              },
              ticks: {
                precision: 0
              }
            },
            x: {
              grid: {
                display: false
              }
            }
          },
          plugins: {
            legend: {
              display: false
            },
            tooltip: {
              backgroundColor: 'rgba(0, 0, 0, 0.8)',
              padding: 12,
              titleFont: {
                size: 14,
                weight: 'bold'
              },
              bodyFont: {
                size: 13
              }
            }
          }
        }
      });
      
      // Set up Top Products Chart
      const topProductsCtx = document.getElementById('topProductsChart').getContext('2d');
      const productNames = topProducts.map(product => product.productName || 'Unknown Product');
      const productRevenue = topProducts.map(product => product.revenue);
      
      new Chart(topProductsCtx, {
        type: 'bar',
        data: {
          labels: productNames,
          datasets: [{
            label: 'Revenue',
            data: productRevenue,
            backgroundColor: 'rgba(139, 92, 246, 0.8)',
            borderRadius: 6,
            borderWidth: 0
          }]
        },
        options: {
          indexAxis: 'y',
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            x: {
              beginAtZero: true,
              grid: {
                color: 'rgba(0, 0, 0, 0.05)'
              },
              ticks: {
                callback: function(value) {
                  return '₹' + value;
                }
              }
            },
            y: {
              grid: {
                display: false
              }
            }
          },
          plugins: {
            legend: {
              display: false
            },
            tooltip: {
              backgroundColor: 'rgba(0, 0, 0, 0.8)',
              padding: 12,
              titleFont: {
                size: 14,
                weight: 'bold'
              },
              bodyFont: {
                size: 13
              },
              callbacks: {
                label: function(context) {
                  return '₹' + context.raw.toFixed(2);
                }
              }
            }
          }
        }
      });
      
      // Set up Top Categories Chart
      const topCategoriesCtx = document.getElementById('topCategoriesChart').getContext('2d');
      const categoryNames = topSellingCategories.map(category => category.categoryName || 'Unknown Category');
      const categoryRevenue = topSellingCategories.map(category => category.revenue);
      
      new Chart(topCategoriesCtx, {
        type: 'polarArea',
        data: {
          labels: categoryNames,
          datasets: [{
            data: categoryRevenue,
            backgroundColor: [
              'rgba(14, 165, 233, 0.7)',
              'rgba(34, 197, 94, 0.7)',
              'rgba(139, 92, 246, 0.7)',
              'rgba(249, 115, 22, 0.7)',
              'rgba(239, 68, 68, 0.7)',
              'rgba(107, 114, 128, 0.7)',
              'rgba(6, 182, 212, 0.7)',
              'rgba(245, 158, 11, 0.7)',
              'rgba(236, 72, 153, 0.7)',
              'rgba(16, 185, 129, 0.7)'
            ],
            borderWidth: 0
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            r: {
              ticks: {
                display: false
              }
            }
          },
          plugins: {
            legend: {
              position: 'right',
              labels: {
                boxWidth: 12,
                padding: 15,
                font: {
                  size: 11
                }
              }
            },
            tooltip: {
              backgroundColor: 'rgba(0, 0, 0, 0.8)',
              padding: 12,
              titleFont: {
                size: 14,
                weight: 'bold'
              },
              bodyFont: {
                size: 13
              },
              callbacks: {
                label: function(context) {
                  return '₹' + context.raw.toFixed(2);
                }
              }
            }
          }
        }
      });
      
      // Set up Top Brands Chart
      const topBrandsCtx = document.getElementById('topBrandsChart').getContext('2d');
      const brandNames = topSellingBrands.map(brand => brand.brandName || 'Unknown Brand');
      const brandRevenue = topSellingBrands.map(brand => brand.revenue);
      
      new Chart(topBrandsCtx, {
        type: 'pie',
        data: {
          labels: brandNames,
          datasets: [{
            data: brandRevenue,
            backgroundColor: [
              'rgba(14, 165, 233, 0.7)',
              'rgba(34, 197, 94, 0.7)',
              'rgba(139, 92, 246, 0.7)',
              'rgba(249, 115, 22, 0.7)',
              'rgba(239, 68, 68, 0.7)',
              'rgba(107, 114, 128, 0.7)',
              'rgba(6, 182, 212, 0.7)',
              'rgba(245, 158, 11, 0.7)',
              'rgba(236, 72, 153, 0.7)',
              'rgba(16, 185, 129, 0.7)'
            ],
            borderWidth: 0
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              position: 'right',
              labels: {
                boxWidth: 12,
                padding: 15,
                font: {
                  size: 11
                }
              }
            },
            tooltip: {
              backgroundColor: 'rgba(0, 0, 0, 0.8)',
              padding: 12,
              titleFont: {
                size: 14,
                weight: 'bold'
              },
              bodyFont: {
                size: 13
              },
              callbacks: {
                label: function(context) {
                  return '₹' + context.raw.toFixed(2);
                }
              }
            }
          }
        }
      });
      
      // Populate Top Selling Products Table
      const topSellingProductsBody = document.getElementById('topSellingProductsBody');
      topSellingProducts.forEach(product => {
        const row = document.createElement('tr');
        
        // Create image element with thumbnail view
        const imgHtml = product.mainImage 
          ? `<img src="/${product.mainImage}" alt="${product.productName}" class="h-10 w-10 rounded-md object-cover">`
          : `<div class="flex items-center justify-center h-10 w-10 rounded-md bg-gray-100">
              <i class="fas fa-image text-gray-400"></i>
             </div>`;
        
        row.innerHTML = `
          <td class="px-6 py-4 whitespace-nowrap">${imgHtml}</td>
          <td class="px-6 py-4 whitespace-nowrap">
            <div class="text-sm font-medium text-gray-900">${product.productName || 'Unknown Product'}</div>
          </td>
          <td class="px-6 py-4 whitespace-nowrap">
            <div class="text-sm text-gray-500">${product.category || 'Uncategorized'}</div>
          </td>
          <td class="px-6 py-4 whitespace-nowrap">
            <div class="text-sm text-gray-500">${product.brand || 'Unbranded'}</div>
          </td>
          <td class="px-6 py-4 whitespace-nowrap">
            <div class="text-sm text-gray-900">₹${product.price ? product.price.toFixed(2) : '0.00'}</div>
          </td>
          <td class="px-6 py-4 whitespace-nowrap">
            <div class="text-sm text-gray-500">${product.stock || 0}</div>
          </td>
          <td class="px-6 py-4 whitespace-nowrap">
            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-primary-100 text-primary-800">
              ${product.totalSold}
            </span>
          </td>
          <td class="px-6 py-4 whitespace-nowrap">
            <div class="text-sm font-medium text-gray-900">₹${product.revenue.toFixed(2)}</div>
          </td>
        `;
        topSellingProductsBody.appendChild(row);
      });
      
      // Populate Top Selling Categories Table
      const topSellingCategoriesBody = document.getElementById('topSellingCategoriesBody');
      topSellingCategories.forEach(category => {
        const row = document.createElement('tr');
        
        // Create a short description by truncating if needed
        const shortDescription = category.categoryDescription?.length > 100 
          ? category.categoryDescription.substring(0, 100) + '...' 
          : category.categoryDescription || 'No description';
        
        row.innerHTML = `
          <td class="px-6 py-4 whitespace-nowrap">
            <div class="text-sm font-medium text-gray-900">${category.categoryName || 'Unknown Category'}</div>
            <div class="text-xs text-gray-500">Slug: ${category.categorySlug || 'N/A'}</div>
          </td>
          <td class="px-6 py-4">
            <div class="text-sm text-gray-500">${shortDescription}</div>
          </td>
          <td class="px-6 py-4 whitespace-nowrap">
            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800">
              ${category.productCount || 0}
            </span>
          </td>
          <td class="px-6 py-4 whitespace-nowrap">
            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-primary-100 text-primary-800">
              ${category.totalSold}
            </span>
          </td>
          <td class="px-6 py-4 whitespace-nowrap">
            <div class="text-sm font-medium text-gray-900">₹${category.revenue.toFixed(2)}</div>
          </td>
        `;
        topSellingCategoriesBody.appendChild(row);
      });
      
      // Populate Top Selling Brands Table
      const topSellingBrandsBody = document.getElementById('topSellingBrandsBody');
      topSellingBrands.forEach(brand => {
        const row = document.createElement('tr');
        
        // Create a short description by truncating if needed
        const shortDescription = brand.brandDescription?.length > 100 
          ? brand.brandDescription.substring(0, 100) + '...' 
          : brand.brandDescription || 'No description';
        
        row.innerHTML = `
          <td class="px-6 py-4 whitespace-nowrap">
            <div class="text-sm font-medium text-gray-900">${brand.brandName || 'Unknown Brand'}</div>
          </td>
          <td class="px-6 py-4">
            <div class="text-sm text-gray-500">${shortDescription}</div>
          </td>
          <td class="px-6 py-4 whitespace-nowrap">
            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800">
              ${brand.productCount || 0}
            </span>
          </td>
          <td class="px-6 py-4 whitespace-nowrap">
            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-primary-100 text-primary-800">
              ${brand.totalSold}
            </span>
          </td>
          <td class="px-6 py-4 whitespace-nowrap">
            <div class="text-sm font-medium text-gray-900">₹${brand.revenue.toFixed(2)}</div>
          </td>
        `;
        topSellingBrandsBody.appendChild(row);
      });
      
      // Show welcome toast on page load
      showToast('Dashboard loaded successfully!', true);
    });
  </script>
</body>
</html>